<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cart - HomeBitez</title>

<link href="https://fonts.googleapis.com/css2?family=Sniglet:wght@700;900&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#faefe5;
}

/* PAGE TITLE */
.page-title{
    text-align:center;
    margin-top:25px;
    font-size:26px;
}
.underline{
    width:70px;
    height:3px;
    background:#dd9b00;
    margin:0 auto 25px;
}

/* CART ITEMS */
.cart-item{
    background:white;
    border-radius:12px;
    padding:15px;
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
    display:flex;
    align-items:center;
    gap:20px;
    margin-bottom:20px;
}
.cart-item img{
    width:100px;
    height:100px;
    border-radius:12px;
    object-fit:cover;
}
.cart-item-details{ flex:1; }

.qty-box{
    display:flex;
    gap:8px;
    margin-top:6px;
}
.qty-btn{
    width:28px;
    height:28px;
    border-radius:50%;
    border:none;
    background:#dd9b00;
    color:white;
    font-weight:bold;
}

.btn-checkout{
    padding:12px 35px;
    background:#dd9b00;
    color:white;
    border-radius:8px;
    border:none;
    font-weight:bold;
}
.btn-back{
    padding:12px 35px;
    border:1px solid #d1b26f;
    background:#fff7ea;
    border-radius:8px;
    font-weight:bold;
}
</style>
</head>

<body>

<%- include('partials/navbar') %>

<div class="container" style="max-width:1000px; padding:20px;">

<h2 class="page-title">Your Cart</h2>
<div class="underline"></div>

<% cart.forEach((item,i)=>{ %>
<div class="cart-item">
    <img src="<%= item.image || '/images/flatlay-iron-skillet-with-meat-and-other-food.jpg' %>">
    <div class="cart-item-details">
        <h5><%= i+1 %>. <%= item.name %></h5>
        <div class="qty-box">
            <button class="qty-btn decrease" data-id="<%= item.id %>">âˆ’</button>
            <strong><%= item.quantity %></strong>
            <button class="qty-btn increase" data-id="<%= item.id %>">+</button>
        </div>
    </div>
    <div class="text-end">$<%= item.price.toFixed(2) %></div>
</div>
<% }) %>

<div class="mt-4 text-end">
    <h5>Subtotal: $<%= subtotal.toFixed(2) %></h5>
</div>

<!-- CUTLERY -->
<div class="mt-4">
    <h6>Cutlery</h6>
    <label class="form-check form-switch mt-2">
        <input id="cutlerySwitch" class="form-check-input" type="checkbox">
    </label>
</div>

<!-- PICKUP DATE & TIME -->
<div class="mt-4">
    <h6>Pickup Date & Time</h6>
    <div class="mt-2">
        <input type="date" id="pickupDate" class="pill">
        <input type="time" id="pickupTime" class="pill">
    </div>
</div>

<div class="mt-4 d-flex gap-3">
    <a href="/menu" class="btn-back">Back to Menu</a>
    <a href="/checkout" class="btn-checkout">Checkout ðŸ›’</a>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.querySelectorAll('.increase,.decrease').forEach(btn=>{
    btn.onclick=()=>{
        fetch('/cart/update',{
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({
                id:btn.dataset.id,
                action:btn.classList.contains('increase')?'increase':'decrease'
            })
        }).then(()=>location.reload());
    }
});
</script>

</body>
</html>

